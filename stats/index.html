<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Statistics & Analytics | Ruston Family Whist Drive</title>
    <meta name="description" content="Deep statistical analysis and visualizations from 40 years of championship data">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="card-suits"><span class="heart">‚ô•</span> <span class="club">‚ô£</span> <span class="diamond">‚ô¶</span> <span class="spade">‚ô†</span></div>
                    <h1 class="site-title">Ruston Family Whist Drive</h1>
                    <p class="site-subtitle">Est. 1984 ‚Ä¢ The World's Most Elite Family Tournament</p>
                </div>
                <nav class="main-nav">
                    <a href="../" class="nav-link">Home</a>
                    <a href="../tournaments/" class="nav-link">Tournaments</a>
                    <a href="../players/" class="nav-link">Players</a>
                    <a href="../leaderboard/" class="nav-link">Hall of Fame</a>
                    <a href="#" class="nav-link active">Statistics</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        <section class="stats-hero">
            <div class="container">
                <div class="hero-content">
                    <div class="analytics-badge">üìä ADVANCED ANALYTICS</div>
                    <h1 class="hero-title">Tournament Statistics & Analysis</h1>
                    <p class="hero-subtitle">Deep insights from decades of championship data, performance trends, and strategic analysis</p>
                </div>
            </div>
        </section>

        <section class="tournament-summary-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üèÜ</span>
                    Tournament Data Overview
                </h2>
                
                <div class="overview-stats-grid" id="overview-stats-grid">
                    <!-- Overview statistics will be loaded dynamically -->
                </div>
            </div>
        </section>

        <section class="analytics-grid-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üìà</span>
                    Performance Analytics
                </h2>
                
                <div class="analytics-grid" id="analytics-grid">
                    <!-- Analytics cards will be loaded dynamically -->
                </div>
            </div>
        </section>

        <section class="advanced-metrics-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üî¨</span>
                    Advanced Performance Metrics
                </h2>
                
                <div class="metrics-grid" id="metrics-grid">
                    <!-- Metrics will be loaded dynamically -->
                </div>
            </div>
        </section>

        <section class="partnership-performance-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">ü§ù</span>
                    Partnership Performance Rankings
                </h2>
                
                <div class="partnership-rankings" id="partnership-rankings">
                    <!-- Partnership rankings will be loaded dynamically -->
                </div>
            </div>
        </section>

        <section class="family-statistics-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                    Family Statistics
                </h2>
                
                <div class="family-stats" id="family-stats">
                    <!-- Family statistics will be loaded dynamically -->
                </div>
            </div>
        </section>

        <section class="statistical-records-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üéØ</span>
                    Statistical Records & Achievements
                </h2>
                
                <div class="records-showcase" id="records-showcase">
                    <!-- Records will be loaded dynamically -->
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Data Analytics</h4>
                    <p id="total-scorecards">Loading...</p>
                    <p id="data-timespan">Loading...</p>
                    <p><a href="../google-sheets-example.html">Data Source Details</a></p>
                </div>
                <div class="footer-section">
                    <h4>Statistics</h4>
                    <p><a href="../leaderboard/">Player Rankings</a></p>
                    <p><a href="../players/">Player Profiles</a></p>
                    <p><a href="../tournaments/">Tournament Archive</a></p>
                </div>
                <div class="footer-section">
                    <h4>Performance</h4>
                    <p>Real-time Analysis</p>
                    <p>Historical Trends</p>
                    <p>Championship Records</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Ruston Family Whist Drive. Advanced analytics from real tournament data.</p>
            </div>
        </div>
    </footer>

            <script src="../assets/js/tournament-engine.js?v=47"></script>
    
    <script>
        // Load real statistical data
        document.addEventListener('DOMContentLoaded', async function() {
            const tournamentEngine = new TournamentEngine();
            const sheetId = '1HGfdlDOfGHOL6Q4MP_TnF8UNE6YihBW-5gQs6Ykl78k';
            
            try {
                console.log('üìä Loading tournament statistics...');
                await tournamentEngine.loadFromGoogleSheets(sheetId);
                
                const players = tournamentEngine.getAllPlayers('total_tricks');
                const tournaments = Array.from(tournamentEngine.tournaments.values());
                
                // Calculate comprehensive statistics
                const totalPlayers = players.length;
                const totalTournaments = tournaments.length;
                const totalRounds = tournaments.reduce((sum, t) => sum + t.total_rounds, 0);
                const totalTricks = players.reduce((sum, p) => sum + p.total_tricks, 0);
                
                const uniqueChampions = new Set(tournaments.map(t => t.winner)).size;
                const averagePlayersPerTournament = totalPlayers / totalTournaments;
                
                // Find top performers
                const topPlayer = players[0];
                const championships = tournaments.filter(t => t.winner === topPlayer.name).length;
                
                // Tournament timespan
                const years = tournaments.map(t => t.year).sort((a, b) => a - b);
                const firstYear = years[0];
                const lastYear = years[years.length - 1];
                
                // Generate overview statistics
                const overviewHTML = `
                    <div class="overview-stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-number">${totalPlayers}</div>
                        <div class="stat-label">Total Players</div>
                        <div class="stat-detail">Across ${totalTournaments} tournaments</div>
                    </div>
                    <div class="overview-stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-number">${totalTournaments}</div>
                        <div class="stat-label">Tournaments</div>
                        <div class="stat-detail">${firstYear} - ${lastYear}</div>
                    </div>
                    <div class="overview-stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-number">${totalTricks.toLocaleString()}</div>
                        <div class="stat-label">Total Tricks</div>
                        <div class="stat-detail">${totalRounds} rounds played</div>
                    </div>
                    <div class="overview-stat-card">
                        <div class="stat-icon">üëë</div>
                        <div class="stat-number">${uniqueChampions}</div>
                        <div class="stat-label">Different Champions</div>
                        <div class="stat-detail">Competitive balance</div>
                    </div>
                `;
                
                document.getElementById('overview-stats-grid').innerHTML = overviewHTML;
                
                // Generate analytics cards
                const topPerformers = players.slice(0, 5);
                const averageTricks = totalTricks / (totalPlayers * totalRounds / totalPlayers);
                
                const analyticsHTML = `
                    <div class="analytics-card">
                        <h3 class="card-title">
                            <span class="card-icon">üèÜ</span>
                            Top Performers
                        </h3>
                        <div class="performers-list">
                            ${topPerformers.map((player, index) => `
                                <div class="performer-item">
                                    <span class="rank">${index + 1}.</span>
                                    <span class="name">${player.name}</span>
                                    <span class="tricks">${player.total_tricks} tricks</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="analytics-card">
                        <h3 class="card-title">
                            <span class="card-icon">üìà</span>
                            Performance Distribution
                        </h3>
                        <div class="distribution-stats">
                            <div class="dist-item">
                                <span class="label">High Performers (>avg):</span>
                                <span class="value">${players.filter(p => p.total_tricks / p.tournaments_played > averageTricks).length}</span>
                            </div>
                            <div class="dist-item">
                                <span class="label">Average Performers:</span>
                                <span class="value">${players.filter(p => {
                                    const avg = p.total_tricks / p.tournaments_played;
                                    return avg <= averageTricks && avg >= averageTricks * 0.8;
                                }).length}</span>
                            </div>
                            <div class="dist-item">
                                <span class="label">Developing Players:</span>
                                <span class="value">${players.filter(p => p.total_tricks / p.tournaments_played < averageTricks * 0.8).length}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analytics-card">
                        <h3 class="card-title">
                            <span class="card-icon">üéØ</span>
                            Tournament Competition
                        </h3>
                        <div class="competition-stats">
                            <div class="comp-item">
                                <span class="label">Average Players per Tournament:</span>
                                <span class="value">${averagePlayersPerTournament.toFixed(1)}</span>
                            </div>
                            <div class="comp-item">
                                <span class="label">Championship Repeats:</span>
                                <span class="value">${tournaments.length - uniqueChampions}</span>
                            </div>
                            <div class="comp-item">
                                <span class="label">Most Championships:</span>
                                <span class="value">${championships} (${topPlayer.name})</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analytics-card">
                        <h3 class="card-title">
                            <span class="card-icon">üìÖ</span>
                            Historical Timeline
                        </h3>
                        <div class="timeline-stats">
                            <div class="time-item">
                                <span class="label">Tournament Era:</span>
                                <span class="value">${lastYear - firstYear + 1} years</span>
                            </div>
                            <div class="time-item">
                                <span class="label">Most Recent Champion:</span>
                                <span class="value">${tournaments[0].winner}</span>
                            </div>
                            <div class="time-item">
                                <span class="label">Longest Active Player:</span>
                                <span class="value">${topPlayer.tournaments_played} tournaments</span>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('analytics-grid').innerHTML = analyticsHTML;
                
                // Generate advanced metrics
                const trumpSuitAnalysis = calculateTrumpSuitAnalysis(tournaments);
                const partnershipAnalysis = calculatePartnershipAnalysis(tournaments);
                
                const metricsHTML = `
                    <div class="metric-category">
                        <h3>Strategic Analysis</h3>
                        <div class="metric-list">
                            <div class="metric-item">
                                <div class="metric-name">Trump Suit Performance</div>
                                <div class="metric-leaders">
                                    ${trumpSuitAnalysis.map(suit => `
                                        <div class="leader">${suit.suit}: ${suit.averageTricks.toFixed(1)} avg tricks</div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Top Consistent Performers</div>
                                <div class="metric-leaders">
                                    ${players.slice(0, 3).map((player, index) => `
                                        <div class="leader">${index + 1}. ${player.name}: ${(player.total_tricks / player.tournaments_played).toFixed(1)} avg per tournament</div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Tournament Participation</div>
                                <div class="metric-leaders">
                                    ${players
                                        .sort((a, b) => b.tournaments_played - a.tournaments_played)
                                        .slice(0, 3)
                                        .map((player, index) => `
                                            <div class="leader">${index + 1}. ${player.name}: ${player.tournaments_played} tournaments</div>
                                        `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="metric-category">
                        <h3>Championship Analysis</h3>
                        <div class="metric-list">
                            <div class="metric-item">
                                <div class="metric-name">Multiple Champions</div>
                                <div class="metric-leaders">
                                    ${getMultipleChampions(tournaments, players).map(champion => `
                                        <div class="leader">${champion.name}: ${champion.championships} championships</div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Recent Champions (Last 5 Tournaments)</div>
                                <div class="metric-leaders">
                                    ${tournaments.slice(0, 5).map(tournament => `
                                        <div class="leader">${tournament.year}: ${tournament.winner}</div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Championship Win Rates</div>
                                <div class="metric-leaders">
                                    ${getMultipleChampions(tournaments, players).map(champion => {
                                        const winRate = (champion.championships / champion.tournaments_played * 100).toFixed(1);
                                        return `<div class="leader">${champion.name}: ${winRate}% win rate</div>`;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="metric-category">
                        <h3>Performance Trends</h3>
                        <div class="metric-list">
                            <div class="metric-item">
                                <div class="metric-name">Tournament Size Evolution</div>
                                <div class="metric-leaders">
                                    <div class="leader">Smallest Tournament: ${Math.min(...tournaments.map(t => t.total_players))} players</div>
                                    <div class="leader">Largest Tournament: ${Math.max(...tournaments.map(t => t.total_players))} players</div>
                                    <div class="leader">Average Size: ${averagePlayersPerTournament.toFixed(1)} players</div>
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Round Distribution</div>
                                <div class="metric-leaders">
                                    <div class="leader">Total Rounds Played: ${totalRounds}</div>
                                    <div class="leader">Average per Tournament: ${(totalRounds / totalTournaments).toFixed(1)}</div>
                                    <div class="leader">Most Rounds: ${Math.max(...tournaments.map(t => t.total_rounds))}</div>
                                </div>
                            </div>
                            
                            <div class="metric-item">
                                <div class="metric-name">Player Engagement</div>
                                <div class="metric-leaders">
                                    <div class="leader">Active in All Tournaments: ${players.filter(p => p.tournaments_played === totalTournaments).length}</div>
                                    <div class="leader">Single Tournament: ${players.filter(p => p.tournaments_played === 1).length}</div>
                                    <div class="leader">Average Participation: ${(totalPlayers / totalTournaments * totalTournaments / totalPlayers).toFixed(1)} tournaments</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('metrics-grid').innerHTML = metricsHTML;
                
                // Generate records showcase
                const recordsHTML = `
                    <div class="record-highlight featured">
                        <div class="record-icon">üëë</div>
                        <div class="record-stat">${championships}</div>
                        <div class="record-content">
                            <h3>Most Championships</h3>
                            <div class="record-details">
                                <p><strong>${topPlayer.name}</strong> holds the record</p>
                                <p>Total tricks: ${topPlayer.total_tricks}</p>
                                <p>Tournaments played: ${topPlayer.tournaments_played}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="record-highlight">
                        <div class="record-icon">üéØ</div>
                        <div class="record-stat">${topPlayer.total_tricks}</div>
                        <div class="record-content">
                            <h3>Most Career Tricks</h3>
                            <div class="record-details">
                                <p><strong>${topPlayer.name}</strong></p>
                                <p>Average per tournament: ${(topPlayer.total_tricks / topPlayer.tournaments_played).toFixed(1)}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="record-highlight">
                        <div class="record-icon">üèÜ</div>
                        <div class="record-stat">${totalTournaments}</div>
                        <div class="record-content">
                            <h3>Tournaments Held</h3>
                            <div class="record-details">
                                <p>Spanning <strong>${lastYear - firstYear + 1} years</strong></p>
                                <p>From ${firstYear} to ${lastYear}</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="record-highlight">
                        <div class="record-icon">‚ö°</div>
                        <div class="record-stat">${Math.max(...players.map(p => p.tournaments_played))}</div>
                        <div class="record-content">
                            <h3>Most Tournaments</h3>
                            <div class="record-details">
                                <p><strong>${players.find(p => p.tournaments_played === Math.max(...players.map(p => p.tournaments_played))).name}</strong></p>
                                <p>Ultimate competitor</p>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('records-showcase').innerHTML = recordsHTML;
                
                // Load partnership performance rankings
                loadPartnershipRankings();
                
                // Load family statistics
                loadFamilyStatistics();
                
                // Update footer
                document.getElementById('total-scorecards').textContent = `${totalRounds} Rounds Analyzed`;
                document.getElementById('data-timespan').textContent = `${lastYear - firstYear + 1} Years of Data`;
                
                console.log('‚úÖ Statistics loaded successfully!');
                
            } catch (error) {
                console.error('‚ùå Error loading statistics:', error);
                document.getElementById('overview-stats-grid').innerHTML = 
                    '<p style="text-align: center; color: #666; padding: 2rem;">Error loading statistics. Please try refreshing the page.</p>';
            }
        });
        
        // Helper functions for advanced calculations
        function calculateTrumpSuitAnalysis(tournaments) {
            const suitStats = {};
            
            tournaments.forEach(tournament => {
                tournament.rounds.forEach(round => {
                    const suit = round.trump_suit;
                    if (!suitStats[suit]) {
                        suitStats[suit] = { totalTricks: 0, roundCount: 0 };
                    }
                    
                    round.tables.forEach(table => {
                        table.partnerships.forEach(partnership => {
                            suitStats[suit].totalTricks += partnership.tricks;
                            suitStats[suit].roundCount++;
                        });
                    });
                });
            });
            
            return Object.entries(suitStats).map(([suit, stats]) => ({
                suit,
                averageTricks: stats.totalTricks / stats.roundCount
            })).sort((a, b) => b.averageTricks - a.averageTricks);
        }
        
        function calculatePartnershipAnalysis(tournaments) {
            // This would implement partnership combination analysis
            // For now, return empty array as it requires more complex data processing
            return [];
        }
        
        function getMultipleChampions(tournaments, players) {
            const championshipCounts = {};
            
            tournaments.forEach(tournament => {
                championshipCounts[tournament.winner] = (championshipCounts[tournament.winner] || 0) + 1;
            });
            
            return Object.entries(championshipCounts)
                .filter(([name, count]) => count > 1)
                .map(([name, championships]) => {
                    const player = players.find(p => p.name === name);
                    return {
                        name,
                        championships,
                        tournaments_played: player ? player.tournaments_played : championships
                    };
                })
                .sort((a, b) => b.championships - a.championships);
        }

        function loadPartnershipRankings() {
            const partnershipRankings = window.tournamentEngine.getPartnershipPerformanceRankings();
            
            const partnershipHTML = `
                <div class="partnership-table-container">
                    <table class="partnership-table">
                        <thead>
                            <tr>
                                <th class="rank-column">Rank</th>
                                <th class="partnership-column">Partnership</th>
                                <th class="avg-tricks-column">Avg Tricks</th>
                                <th class="total-tricks-column">Total Tricks</th>
                                <th class="rounds-column">Rounds</th>
                                <th class="count-column">Partnerships</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${partnershipRankings.slice(0, 20).map((partnership, index) => `
                                <tr>
                                    <td class="rank-column">${index + 1}</td>
                                    <td class="partnership-column">
                                        <div class="partnership-names">
                                            <a href="../players/profile.html?player=${encodeURIComponent(partnership.players[0])}" class="player-name-link">${partnership.players[0]}</a>
                                            <span class="partnership-separator">&</span>
                                            <a href="../players/profile.html?player=${encodeURIComponent(partnership.players[1])}" class="player-name-link">${partnership.players[1]}</a>
                                        </div>
                                    </td>
                                    <td class="avg-tricks-column">${partnership.average_tricks.toFixed(2)}</td>
                                    <td class="total-tricks-column">${partnership.total_tricks}</td>
                                    <td class="rounds-column">${partnership.total_rounds}</td>
                                    <td class="count-column">${partnership.partnerships_count}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('partnership-rankings').innerHTML = partnershipHTML;
        }

        function loadFamilyStatistics() {
            const familyStats = window.tournamentEngine.getFamilyStatistics();
            
            const familyHTML = `
                <div class="family-stats-grid">
                    ${familyStats.slice(0, 10).map((family, index) => `
                        <div class="family-stat-card">
                            <div class="family-rank">#${index + 1}</div>
                            <div class="family-header">
                                <h3 class="family-name">${family.family_name} Family</h3>
                                <div class="family-average">${family.average_tricks_per_player.toFixed(2)} avg tricks</div>
                            </div>
                            <div class="family-members">
                                <div class="member-count">${family.total_players} ${family.total_players === 1 ? 'member' : 'members'}</div>
                                <div class="member-list">
                                    ${family.members.map(member => `
                                        <a href="../players/profile.html?player=${encodeURIComponent(member.name)}" class="member-link">
                                            ${member.name}
                                        </a>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="family-stats-grid-details">
                                <div class="family-stat-item">
                                    <span class="stat-label">Total Tricks</span>
                                    <span class="stat-value">${family.total_tricks.toLocaleString()}</span>
                                </div>
                                <div class="family-stat-item">
                                    <span class="stat-label">Championships</span>
                                    <span class="stat-value">${family.tournament_wins}</span>
                                </div>
                                <div class="family-stat-item">
                                    <span class="stat-label">Tournaments</span>
                                    <span class="stat-value">${family.total_tournaments}</span>
                                </div>
                                <div class="family-stat-item">
                                    <span class="stat-label">Win Rate</span>
                                    <span class="stat-value">${family.win_rate.toFixed(1)}%</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('family-stats').innerHTML = familyHTML;
        }
    </script>
    
    <style>
        /* Statistics Page Specific Styles */
        .stats-hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: var(--spacing-3xl) 0;
            position: relative;
            overflow: hidden;
        }

        .stats-hero::before {
            content: 'üìä';
            position: absolute;
            top: 50%;
            right: 5%;
            transform: translateY(-50%);
            font-size: 15rem;
            opacity: 0.1;
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .analytics-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: var(--border-radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            margin-bottom: var(--spacing-lg);
            display: inline-block;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-primary);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .tournament-summary-section {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-primary);
        }

        .overview-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-xl);
        }

        .overview-stat-card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-lg);
            text-align: center;
            border: 2px solid var(--border-light);
            transition: all 0.2s ease;
        }

        .overview-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .overview-stat-card .stat-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
        }

        .overview-stat-card .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: var(--spacing-sm);
            display: block;
        }

        .overview-stat-card .stat-label {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .overview-stat-card .stat-detail {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .analytics-grid-section {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-secondary);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-2xl);
        }

        .analytics-card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-light);
            transition: all 0.2s ease;
        }

        .analytics-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            font-size: 1.125rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        .performers-list, .distribution-stats, .competition-stats, .timeline-stats {
            display: grid;
            gap: var(--spacing-md);
        }

        .performer-item, .dist-item, .comp-item, .time-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm);
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        .performer-item .rank {
            font-weight: 600;
            color: var(--primary);
            min-width: 20px;
        }

        .performer-item .name {
            flex: 1;
            margin-left: var(--spacing-sm);
        }

        .performer-item .tricks {
            font-weight: 500;
            color: var(--text-secondary);
        }

        .label {
            font-weight: 500;
            color: var(--text-primary);
        }

        .value {
            font-weight: 600;
            color: var(--primary);
        }

        .advanced-metrics-section {
            padding: var(--spacing-3xl) 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-2xl);
        }

        .metric-category {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-lg);
        }

        .metric-category h3 {
            color: var(--primary);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--primary);
            font-size: 1.25rem;
        }

        .metric-list {
            display: grid;
            gap: var(--spacing-lg);
        }

        .metric-item {
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        .metric-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .metric-leaders {
            display: grid;
            gap: var(--spacing-xs);
        }

        .leader {
            font-size: 0.875rem;
            color: var(--text-secondary);
            padding: var(--spacing-xs) 0;
        }

        .statistical-records-section {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-secondary);
        }

        .records-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-xl);
        }

        .record-highlight {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-2xl);
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-light);
            text-align: center;
            transition: all 0.2s ease;
        }

        .record-highlight:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .record-highlight.featured {
            border-color: var(--gold);
            background: linear-gradient(135deg, white 0%, #fef3c7 100%);
        }

        .record-icon {
            font-size: 4rem;
            margin-bottom: var(--spacing-lg);
        }

        .record-stat {
            font-size: 2.5rem;
            font-weight: 900;
            font-family: var(--font-primary);
            color: var(--primary);
            margin-bottom: var(--spacing-md);
        }

        .record-content h3 {
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            font-size: 1.25rem;
        }

        .record-details p {
            margin-bottom: var(--spacing-sm);
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .record-details strong {
            color: var(--primary);
        }

        /* Partnership Performance Styles */
        .partnership-performance-section {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-primary);
        }

        .partnership-table-container {
            background: white;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-light);
        }

        .partnership-table {
            width: 100%;
            border-collapse: collapse;
        }

        .partnership-table th {
            background: var(--primary);
            color: white;
            padding: var(--spacing-lg);
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .partnership-table td {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
            color: var(--text-primary);
        }

        .partnership-table tbody tr:hover {
            background: var(--bg-secondary);
        }

        .partnership-names {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .partnership-separator {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .player-name-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .player-name-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        .rank-column {
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            width: 60px;
        }

        .avg-tricks-column, .total-tricks-column, .rounds-column, .count-column {
            text-align: center;
            font-weight: 500;
        }

        /* Family Statistics Styles */
        .family-statistics-section {
            padding: var(--spacing-3xl) 0;
            background: white;
        }

        .family-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-xl);
        }

        .family-stat-card {
            background: var(--bg-primary);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-light);
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .family-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary);
        }

        .family-rank {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            background: var(--primary);
            color: white;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-full);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .family-header {
            margin-bottom: var(--spacing-lg);
        }

        .family-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .family-average {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
        }

        .family-members {
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .member-count {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
            font-weight: 500;
        }

        .member-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .member-link {
            background: white;
            color: var(--primary);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border: 1px solid var(--border-light);
        }

        .member-link:hover {
            background: var(--primary);
            color: white;
        }

        .family-stats-grid-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
        }

        .family-stat-item {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .family-stat-item .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .family-stat-item .stat-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .overview-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .family-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .partnership-table-container {
                overflow-x: auto;
            }
            
            .partnership-table {
                min-width: 600px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .records-showcase {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>