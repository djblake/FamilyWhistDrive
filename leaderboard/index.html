<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hall of Fame - Player Rankings | Ruston Family Whist Drive</title>
    <meta name="description" content="Official rankings and leaderboards for the world's most prestigious family tournament - 40 years of championship excellence">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="card-suits"><span class="heart">‚ô•</span> <span class="club">‚ô£</span> <span class="diamond">‚ô¶</span> <span class="spade">‚ô†</span></div>
                    <h1 class="site-title">Ruston Family Whist Drive</h1>
                    <p class="site-subtitle">Est. 1984 ‚Ä¢ The World's Most Elite Family Tournament</p>
                </div>
                <nav class="main-nav">
                    <a href="../" class="nav-link">Home</a>
                    <a href="../tournaments/" class="nav-link">Tournaments</a>
                    <a href="../players/" class="nav-link">Players</a>
                    <a href="#" class="nav-link active">Hall of Fame</a>
                    <a href="../stats/" class="nav-link">Statistics</a>
                </nav>
            </div>
        </div>
    </header>

    <div id="data-issues-banner" class="data-issues-banner" style="display: none;"></div>

    <main class="main-content">
        <section class="leaderboard-hero">
            <div class="container">
                <div class="hero-content">
                    <div class="hall-of-fame-badge">üèõÔ∏è HALL OF FAME</div>
                    <h1 class="hero-title">Championship Rankings</h1>
                    <p class="hero-subtitle">The Official Leaderboards of the World's Most Prestigious Family Tournament</p>
                </div>
            </div>
        </section>

        <section class="current-rankings">
            <div class="container">
                <div class="ranking-filters">
                    <button class="filter-btn active" data-ranking="overall">Official Seed Ranking</button>
                    <button class="filter-btn" data-ranking="championships">Tournament Wins</button>
                    <button class="filter-btn" data-ranking="booby">Booby Leaderboard</button>
                    <button class="filter-btn" data-ranking="career_stats">Career Wins</button>
                    <button class="filter-btn" data-ranking="recent_form">Recent Form</button>
                    <button class="filter-btn" data-ranking="performance">Performance</button>
                </div>

                <div class="rankings-header">
                    <h2 class="rankings-title" id="current-ranking-title">Official Seed Rankings</h2>
                    <p class="rankings-subtitle" id="current-ranking-description">Comprehensive ranking based on tournament victories, career performance, and recent form</p>
                </div>

                <div class="full-rankings">
                    <div class="rankings-table">
                        <div class="rankings-table-header">
                            <div class="rank-col">Rank</div>
                            <div class="player-col">Player</div>
                            <div class="score-col">Score</div>
                            <div class="tournaments-col">Tournaments</div>
                            <div class="wins-col">Wins</div>
                            <div class="percentage-col">Win %</div>
                            <div class="trend-col">Trend</div>
                        </div>
                        <div class="rankings-table-body" id="rankings-table-body">
                            <!-- Rankings will be populated here -->
                        </div>
                    </div>
                    
                    <div class="table-controls">
                        <button id="toggle-view-btn" class="toggle-view-btn">
                            <span class="btn-text">See All Players</span>
                            <span class="btn-icon">üëÅÔ∏è</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section class="ranking-insights">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üìä</span>
                    Championship Insights & Analysis
                </h2>
                
                <div class="insights-grid">
                    <div class="insight-card featured">
                        <div class="insight-icon">üëë</div>
                        <h3>Current Dynasty</h3>
                        <div class="insight-content">
                            <p><strong>David</strong> claimed victory in the historic "[2000] Covid Begins!" tournament, demonstrating exceptional skill in this family competition.</p>
                            <div class="insight-stat">
                                <span class="stat-number">1</span>
                                <span class="stat-label">Tournament Victory</span>
                            </div>
                        </div>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon">üèÜ</div>
                        <h3>All-Time Champion</h3>
                        <div class="insight-content">
                            <p><strong>James Ruston Sr.</strong> remains the tournament GOAT with 12 total championships spanning four decades of excellence.</p>
                            <div class="insight-stat">
                                <span class="stat-number">12</span>
                                <span class="stat-label">Total Championships</span>
                            </div>
                        </div>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon">‚ö°</div>
                        <h3>Rising Star</h3>
                        <div class="insight-content">
                            <p><strong>Emma Jones</strong> broke the youngest winner record at age 21 and shows championship potential for the next generation.</p>
                            <div class="insight-stat">
                                <span class="stat-number">21</span>
                                <span class="stat-label">Age at First Win</span>
                            </div>
                        </div>
                    </div>

                    <div class="insight-card">
                        <div class="insight-icon">üéØ</div>
                        <h3>Consistency King</h3>
                        <div class="insight-content">
                            <p><strong>David Smith</strong> holds the record for most top-3 finishes (28) and has never finished last in 25+ tournaments.</p>
                            <div class="insight-stat">
                                <span class="stat-number">28</span>
                                <span class="stat-label">Top-3 Finishes</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="historical-champions">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">üìú</span>
                    Championship History
                </h2>
                
                <div class="champions-timeline" id="champions-timeline">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <div class="championship-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-content">
                            <h4>Total Championships</h4>
                            <div class="stat-number">40</div>
                            <div class="stat-detail">Four Decades of Excellence</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h4>Total Champions</h4>
                            <div class="stat-number">15</div>
                            <div class="stat-detail">Different Winners</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üîÑ</div>
                        <div class="stat-content">
                            <h4>Most Consecutive</h4>
                            <div class="stat-number">3</div>
                            <div class="stat-detail">Margaret Wilson (2021-2023)</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-content">
                            <h4>Participation Rate</h4>
                            <div class="stat-number">94%</div>
                            <div class="stat-detail">Average Family Attendance</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="records-section">
            <div class="container">
                <h2 class="section-title">
                    <span class="title-icon">ü•á</span>
                    Tournament Records & Achievements
                </h2>
                
                <div class="records-grid">
                    <div class="record-category">
                        <h3>Championship Records</h3>
                        <div class="record-list">
                            <div class="record-item">
                                <span class="record-title">Most Championships</span>
                                <span class="record-holder">James Ruston Sr. (12)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most Consecutive</span>
                                <span class="record-holder">James Ruston Sr. / Margaret Wilson (3)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Youngest Winner</span>
                                <span class="record-holder">Emma Jones (Age 21)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Oldest Winner</span>
                                <span class="record-holder">Tom Wilson (Age 76)</span>
                            </div>
                        </div>
                    </div>

                    <div class="record-category">
                        <h3>Performance Records</h3>
                        <div class="record-list">
                            <div class="record-item">
                                <span class="record-title">Highest Tournament Score</span>
                                <span class="record-holder">James Ruston Sr. (142 tricks, 1998)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Best Win Percentage</span>
                                <span class="record-holder">Margaret Wilson (68.0%)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most Career Wins</span>
                                <span class="record-holder">James Ruston Sr. (156)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most 11-Trick Rounds</span>
                                <span class="record-holder">Margaret Wilson (47)</span>
                            </div>
                        </div>
                    </div>

                    <div class="record-category">
                        <h3>Participation Records</h3>
                        <div class="record-list">
                            <div class="record-item">
                                <span class="record-title">Perfect Attendance</span>
                                <span class="record-holder">Tom Wilson (40 years)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most Tournaments</span>
                                <span class="record-holder">James Ruston Sr. (40)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most Top-3 Finishes</span>
                                <span class="record-holder">David Smith (28)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Never Last Place</span>
                                <span class="record-holder">David Smith (25 tournaments)</span>
                            </div>
                        </div>
                    </div>

                    <div class="record-category">
                        <h3>Partnership Records</h3>
                        <div class="record-list">
                            <div class="record-item">
                                <span class="record-title">Best Partnership</span>
                                <span class="record-holder">Margaret Wilson & James Ruston (73% success)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Most Partnerships</span>
                                <span class="record-holder">James Ruston Sr. (156 different partners)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Family Chemistry</span>
                                <span class="record-holder">Ruston Brothers (68% success rate)</span>
                            </div>
                            <div class="record-item">
                                <span class="record-title">Cross-Generation</span>
                                <span class="record-holder">Tom Wilson & Emma Jones (65% success)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Hall of Fame</h4>
                    <p><a href="../players/margaret-wilson/">Margaret Wilson</a></p>
                    <p><a href="../players/james-ruston/">James Ruston Sr.</a></p>
                    <p><a href="../players/">All Champions</a></p>
                </div>
                <div class="footer-section">
                    <h4>Statistics</h4>
                    <p><a href="../stats/">Advanced Analytics</a></p>
                    <p>Head-to-Head Records</p>
                    <p>Partnership Analysis</p>
                </div>
                <div class="footer-section">
                    <h4>Tournament History</h4>
                    <p><a href="../tournaments/">All Tournaments</a></p>
                    <p>Championship Timeline</p>
                    <p>Record Performances</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Ruston Family Whist Drive. Hall of Fame excellence since 1984.</p>
            </div>
        </div>
    </footer>

            <script src="../assets/js/tournament-engine.js?v=60"></script>
    
    <script>
        // Leaderboard specific JavaScript
        let currentRankingType = 'overall';
        let allPlayers = [];
        let tournamentEngine = null;
        let showingAllPlayers = false;
        let currentSortedPlayers = [];
        let recentFormScores = new Map();
        let performanceScores = new Map();

        const rankingTypes = ['overall', 'championships', 'booby', 'career_stats', 'recent_form', 'performance'];
        const validRankingTypes = new Set(rankingTypes);
        const urlParams = new URLSearchParams(window.location.search);
        const initialRankingParam = urlParams.get('tab') || urlParams.get('ranking');
        if (initialRankingParam && validRankingTypes.has(initialRankingParam)) {
            currentRankingType = initialRankingParam;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeLeaderboard();
        });

        async function initializeLeaderboard() {
            try {
                // Initialize engine and load real data
                tournamentEngine = new TournamentEngine();
                const sheetId = '1HGfdlDOfGHOL6Q4MP_TnF8UNE6YihBW-5gQs6Ykl78k';

                console.log('üèÜ Loading real tournament data for Hall of Fame...');
                await tournamentEngine.loadFromGoogleSheets(sheetId);
                renderDataIssuesBanner(tournamentEngine.getDataIssues());

                // Get all players with comprehensive stats from real data
                allPlayers = tournamentEngine.getAllPlayers('overall');
                
                // Pre-calculate recent form and performance scores from actual tournament results
                recentFormScores = typeof tournamentEngine.calculateRecentFormScores === 'function'
                    ? tournamentEngine.calculateRecentFormScores(5)
                    : new Map();
                performanceScores = typeof tournamentEngine.calculatePerformanceScores === 'function'
                    ? tournamentEngine.calculatePerformanceScores()
                    : new Map();
                
                // Initialize rankings display
                updateRankingsDisplay(currentRankingType);
                
                // Generate championship history from real data
                generateChampionshipHistory();
                
                // Add filter event listeners
                setupFilterListeners();
                
                // Add toggle view event listener
                setupToggleViewListener();

                console.log('üèÜ Hall of Fame loaded successfully with real data');

            } catch (error) {
                console.error('Error loading leaderboard:', error);
                loadFallbackData();
                if (tournamentEngine && typeof tournamentEngine.getDataIssues === 'function') {
                    renderDataIssuesBanner(tournamentEngine.getDataIssues());
                } else {
                    renderDataIssuesBanner(null);
                }
            }
        }

        function setupFilterListeners() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const rankingType = this.dataset.ranking;
                    if (rankingType === currentRankingType) return;
                    updateRankingsDisplay(rankingType);
                });
            });
        }

        function setActiveFilterButton(rankingType) {
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.classList.toggle('active', button.dataset.ranking === rankingType);
            });
        }

        function updateURLWithRanking(rankingType) {
            const params = new URLSearchParams(window.location.search);
            if (rankingType === 'overall') {
                params.delete('tab');
                params.delete('ranking');
            } else {
                params.set('tab', rankingType);
            }
            const newQuery = params.toString();
            const newUrl = newQuery ? `${window.location.pathname}?${newQuery}` : window.location.pathname;
            window.history.replaceState(null, '', newUrl);
        }

        function setupToggleViewListener() {
            const toggleBtn = document.getElementById('toggle-view-btn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', function() {
                    const wasShowingAll = showingAllPlayers;
                    showingAllPlayers = !showingAllPlayers;
                    updateToggleButton();
                    updateRankingsTable(currentSortedPlayers, showingAllPlayers ? currentSortedPlayers.length : 10);
                    
                    // If we just switched from showing all to showing top 10, scroll to top of table
                    if (wasShowingAll && !showingAllPlayers) {
                        const rankingsTitle = document.getElementById('current-ranking-title');
                        if (rankingsTitle) {
                            rankingsTitle.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'start' 
                            });
                        }
                    }
                });
            }
        }

        const TRICK_WARNING_STORAGE_KEY = 'whist_hide_trick_mismatch_warning';

        function shouldDisplayTrickWarnings() {
            if (typeof window !== 'undefined' && window.TournamentUIConfig && window.TournamentUIConfig.showTrickImbalanceWarnings === false) {
                return false;
            }
            if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {
                return true;
            }
            try {
                return localStorage.getItem(TRICK_WARNING_STORAGE_KEY) !== 'true';
            } catch (error) {
                console.warn('Unable to read trick warning preference from localStorage:', error);
                return true;
            }
        }

        function summarizeTrickMismatchIssues(issues) {
            const tableMap = new Map();
            const roundSet = new Set();

            issues.forEach(issue => {
                const tournamentLabel = issue.tournament || issue.tournamentId || (issue.year ? `Year ${issue.year}` : 'Tournament');
                const roundLabel = typeof issue.round === 'number' ? issue.round : 'Unknown';
                const tableLabel = typeof issue.table === 'number' ? issue.table : 'Unknown';
                const roundKey = `${tournamentLabel}::${roundLabel}`;
                const tableKey = `${roundKey}::${tableLabel}`;

                roundSet.add(roundKey);
                if (!tableMap.has(tableKey)) {
                    tableMap.set(tableKey, {
                        tournament: tournamentLabel,
                        round: roundLabel,
                        table: tableLabel,
                        total: Number.isFinite(issue.actual) ? issue.actual : issue.actual || 'Unknown'
                    });
                }
            });

            return {
                totalRounds: roundSet.size,
                totalTables: tableMap.size,
                samples: Array.from(tableMap.values())
            };
        }

        function attachTrickWarningDismissHandler(banner) {
            const dismissButton = banner.querySelector('[data-dismiss-trick-warning]');
            if (!dismissButton) {
                return;
            }

            dismissButton.addEventListener('click', () => {
                try {
                    localStorage.setItem(TRICK_WARNING_STORAGE_KEY, 'true');
                } catch (error) {
                    console.warn('Unable to persist trick warning preference:', error);
                }

                const warningBlock = banner.querySelector('.data-issues-banner__warning');
                if (warningBlock) {
                    warningBlock.remove();
                }

                const hasErrors = banner.querySelector('.data-issues-banner__errors');
                if (!hasErrors) {
                    banner.style.display = 'none';
                    banner.innerHTML = '';
                }
            }, { once: true });
        }

        function renderDataIssuesBanner(dataIssuesSummary) {
            const banner = document.getElementById('data-issues-banner');
            if (!banner || !dataIssuesSummary || !Array.isArray(dataIssuesSummary.issues)) {
                if (banner) {
                    banner.style.display = 'none';
                    banner.innerHTML = '';
                }
                return;
            }

            const issues = dataIssuesSummary.issues;
            const errorIssues = issues.filter(issue => issue.severity === 'error');
            const trickWarnings = shouldDisplayTrickWarnings()
                ? issues.filter(issue => issue.type === 'trick_count_mismatch')
                : [];

            if (errorIssues.length === 0 && trickWarnings.length === 0) {
                banner.style.display = 'none';
                banner.innerHTML = '';
                return;
            }

            let bannerSections = '';

            if (errorIssues.length > 0) {
                const issueList = errorIssues.map(issue => {
                    const location = issue.sheet ? `${issue.sheet}${issue.row ? ` (Row ${issue.row})` : ''}` : '';
                    const message = issue.message || issue.details || 'An unknown data error occurred.';
                    return `<li>${location ? `<strong>${location}:</strong> ` : ''}${message}</li>`;
                }).join('');

                bannerSections += `
                    <div class="data-issues-banner__errors">
                        <strong>Data Import Errors Detected</strong>
                        <ul>${issueList}</ul>
                    </div>
                `;
            }

            if (trickWarnings.length > 0) {
                const summary = summarizeTrickMismatchIssues(trickWarnings);
                const warningItems = summary.samples.slice(0, 3).map(entry => {
                    return `<li>${entry.tournament} ¬∑ Round ${entry.round}, Table ${entry.table} (reported total: ${entry.total})</li>`;
                }).join('');

                bannerSections += `
                    <div class="data-issues-banner__warning">
                        <div class="data-issues-banner__warning-header">
                            <strong>Trick totals look unbalanced</strong>
                            <span class="data-issues-banner__pill">${summary.totalTables} table${summary.totalTables === 1 ? '' : 's'}</span>
                            <span class="data-issues-banner__pill">${summary.totalRounds} round${summary.totalRounds === 1 ? '' : 's'}</span>
                        </div>
                        <p>Each table should total 13 tricks. Historical data currently shows ${summary.totalTables} table${summary.totalTables === 1 ? '' : 's'} across ${summary.totalRounds} round${summary.totalRounds === 1 ? '' : 's'} where the totals differ.</p>
                        ${warningItems ? `<ul class="data-issues-banner__warning-list">${warningItems}</ul>` : ''}
                        <button type="button" class="data-issues-banner__dismiss" data-dismiss-trick-warning>
                            Hide trick mismatch warning
                        </button>
                    </div>
                `;
            }

            banner.innerHTML = `<div class="data-issues-banner__content">${bannerSections}</div>`;
            banner.style.display = 'block';
            attachTrickWarningDismissHandler(banner);
        }

        function updateToggleButton() {
            const toggleBtn = document.getElementById('toggle-view-btn');
            const btnText = toggleBtn.querySelector('.btn-text');
            const btnIcon = toggleBtn.querySelector('.btn-icon');
            
            if (showingAllPlayers) {
                btnText.textContent = 'Show Top 10 Only';
                btnIcon.textContent = 'üîü';
                toggleBtn.classList.add('showing-all');
            } else {
                btnText.textContent = 'See All Players';
                btnIcon.textContent = 'üëÅÔ∏è';
                toggleBtn.classList.remove('showing-all');
            }
        }

        function updateRankingsDisplay(rankingType) {
            let sortedPlayers;
            currentRankingType = rankingType;
            
            if (rankingType === 'overall') {
                // Use the new Official Seed Ranking system
                if (tournamentEngine && typeof tournamentEngine.getOfficialSeedRankings === 'function') {
                    sortedPlayers = tournamentEngine.getOfficialSeedRankings(true);
                } else {
                    console.warn('Official seed rankings not available, falling back to legacy method');
                    sortedPlayers = sortPlayersByRanking(allPlayers, rankingType);
                }
            } else {
                sortedPlayers = sortPlayersByRanking(allPlayers, rankingType);
            }
            
            // Store sorted players for toggle functionality
            currentSortedPlayers = sortedPlayers;
            
            // Update title and description
            updateRankingInfo(rankingType);
            
            // Preserve the current view state (top 10 or all players)
            updateToggleButton();
            
            // Update rankings table with current view preference
            updateRankingsTable(sortedPlayers, showingAllPlayers ? sortedPlayers.length : 10);
            
            setActiveFilterButton(rankingType);
            updateURLWithRanking(rankingType);
        }

        function sortPlayersByRanking(players, rankingType) {
            if (rankingType === 'booby') {
                return players
                    .map(player => ({ ...player }))
                    .sort((a, b) => {
                        const boobyDiff = (b.booby_prizes || 0) - (a.booby_prizes || 0);
                        if (boobyDiff !== 0) {
                            return boobyDiff;
                        }
                        const pctDiff = (b.booby_percentage || 0) - (a.booby_percentage || 0);
                        if (pctDiff !== 0) {
                            return pctDiff;
                        }
                        return (a.tournaments_played || 0) - (b.tournaments_played || 0);
                    });
            }

            const playersWithScores = players.map(player => ({
                ...player,
                rankingScore: calculateRankingScore(player, rankingType)
            }));

            return playersWithScores.sort((a, b) => {
                if (rankingType === 'recent_form') {
                    // For recent form, higher is better
                    return b.rankingScore - a.rankingScore;
                }
                return b.rankingScore - a.rankingScore;
            });
        }

        function calculateRankingScore(player, rankingType) {
            switch (rankingType) {
                case 'overall':
                    // Legacy weighted combination of multiple factors
                    const tournamentWeight = (player.tournament_wins || 0) * 10;
                    const winPctWeight = parseFloat(player.win_percentage || 0) * 2;
                    const careerWeight = (player.career_wins || 0) * 0.1;
                    const consistencyWeight = (player.top_three_finishes || 0) * 0.5;
                    return tournamentWeight + winPctWeight + careerWeight + consistencyWeight;
                
                case 'championships':
                    return player.tournament_wins || 0;
                
                case 'career_stats':
                    // Sort by win percentage (rounds_won / total_rounds)
                    const winRate = player.total_rounds > 0 ? (player.rounds_won / player.total_rounds) * 100 : 0;
                    return winRate;
                
                case 'recent_form':
                    // Use recent form scores derived from latest tournaments
                    return recentFormScores.get(player.name) || 0;
                
                case 'performance':
                    if (!performanceScores.size) return 0;
                    const percentile = performanceScores.get(player.name);
                    if (typeof percentile !== 'number') return 0;
                    // Lower percentile is better, so convert to performance score where higher is better
                    return 100 - percentile;
                case 'booby':
                    return player.booby_prizes || 0;
                
                default:
                    return 0;
            }
        }

        function updateRankingInfo(rankingType) {
            const titleElement = document.getElementById('current-ranking-title');
            const descElement = document.getElementById('current-ranking-description');
            
            const rankingInfo = {
                overall: {
                    title: 'Official Seed Rankings',
                    desc: 'Weighted ranking system prioritizing recent performance, consistency, and tournament achievements'
                },
                championships: {
                    title: 'Tournament Championships',
                    desc: 'Players ranked by total number of tournament victories achieved'
                },
                career_stats: {
                    title: 'Career Wins',
                    desc: 'Players ranked by round win percentage - total rounds won vs rounds played'
                },
                recent_form: {
                    title: 'Recent Form Rankings',
                    desc: 'Current performance and momentum based on last 5 tournaments'
                },
                performance: {
                    title: 'Performance Rankings',
                    desc: 'Average tournament finish position as a top percentile adjusted for tournament size (lower percentile = better ‚Äî e.g., top 10%)'
                },
                booby: {
                    title: 'Booby Leaderboard',
                    desc: 'Number of booby prizes (last-place finishes) earned, plus the share of tournaments where a player finished last'
                }
            };
            
            const info = rankingInfo[rankingType] || rankingInfo.overall;
            titleElement.textContent = info.title;
            descElement.textContent = info.desc;
        }



        function updateRankingsTable(players, limit = players.length) {
            const tableBody = document.getElementById('rankings-table-body');
            
            // Update table headers based on ranking type
            updateTableHeaders(currentRankingType);
            
            // Limit the number of players shown
            const displayPlayers = players.slice(0, limit);
            
            const tableHTML = displayPlayers.map((player, index) => {
                const trend = generateTrendIndicator(player, index + 1, currentRankingType);
                const medalIcon = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                
                if (currentRankingType === 'career_stats') {
                    // Special layout for Career Wins
                    const roundsWonDisplay = (player.rounds_won ?? 0).toFixed(1);
                    const roundsPlayedDisplay = (player.total_rounds ?? 0).toFixed(1);
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="rounds-won-col">${roundsWonDisplay}</div>
                            <div class="rounds-played-col">${roundsPlayedDisplay}</div>
                            <div class="score-col">${player.total_rounds > 0 ? ((player.rounds_won / player.total_rounds) * 100).toFixed(1) : '0.0'}%</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                } else if (currentRankingType === 'performance') {
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="score-col">${formatScoreDisplay(player, currentRankingType)}</div>
                            <div class="tournaments-col">${player.tournaments_played || 0}</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                } else if (currentRankingType === 'championships') {
                    const topThreeDisplay = player.top_three_finishes ?? player.top_three ?? 0;
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="wins-col">${player.tournament_wins || 0}</div>
                            <div class="podium-col">${topThreeDisplay}</div>
                            <div class="tournaments-col">${player.tournaments_played || 0}</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                } else if (currentRankingType === 'booby') {
                    const boobyWins = player.booby_prizes || 0;
                    const totalTournaments = player.tournaments_played || 0;
                    let boobyPctValue = typeof player.booby_percentage === 'number'
                        ? player.booby_percentage
                        : parseFloat(player.booby_percentage);
                    if (Number.isNaN(boobyPctValue)) {
                        boobyPctValue = totalTournaments > 0 ? (boobyWins / totalTournaments) * 100 : 0;
                    }
                    const boobyPctDisplay = boobyPctValue.toFixed(1);
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="booby-count-col">${boobyWins}</div>
                            <div class="booby-percent-col">${boobyPctDisplay}%</div>
                            <div class="tournaments-col">${totalTournaments}</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                } else if (currentRankingType === 'overall') {
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="score-col">${formatScoreDisplay(player, currentRankingType)}</div>
                            <div class="recent-col">${player.tournaments_in_period ?? 0}</div>
                            <div class="wins-col">${player.championships ?? 0}</div>
                            <div class="podium-col">${player.podium_finishes ?? 0}</div>
                            <div class="avg-finish-col">${player.avg_finish ?? '‚Äî'}</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                } else {
                    // Standard layout for other ranking types
                    return `
                        <div class="ranking-row ${index < 3 ? 'podium-row' : ''}">
                            <div class="rank-col">
                                <span class="rank-number">${index + 1}</span>
                                <span class="rank-medal">${medalIcon}</span>
                            </div>
                            <div class="player-col">
                                <a href="../players/profile.html?player=${encodeURIComponent(player.name)}" class="player-link">
                                    <span class="player-name">${tournamentEngine.getDisplayName(player.name)}</span>
                                    <span class="player-nickname">${getPlayerNickname(player.name)}</span>
                                </a>
                            </div>
                            <div class="score-col">${formatScoreDisplay(player, currentRankingType)}</div>
                            <div class="tournaments-col">${player.tournaments_played || 0}</div>
                            <div class="wins-col">${player.tournament_wins || 0}</div>
                            <div class="percentage-col">${player.win_percentage || '0.0'}%</div>
                            <div class="trend-col">${trend}</div>
                        </div>
                    `;
                }
            }).join('');
            
            tableBody.innerHTML = tableHTML;
        }

        function updateTableHeaders(rankingType) {
            const tableHeader = document.querySelector('.rankings-table-header');
            const rankingsTable = document.querySelector('.full-rankings');

            rankingsTable.classList.remove('career-stats', 'performance-stats', 'seed-stats', 'championships-layout', 'booby-stats');
            
            if (rankingType === 'career_stats') {
                // Add career-stats class for special layout
                rankingsTable.classList.add('career-stats');
                
                // Special layout for Career Wins
                tableHeader.innerHTML = `
                    <div class="rank-col">Rank</div>
                    <div class="player-col">Player</div>
                    <div class="rounds-won-col">Rounds Won</div>
                    <div class="rounds-played-col">Rounds Played</div>
                    <div class="score-col">Round Win %</div>
                    <div class="trend-col">Trend</div>
                `;
            } else if (rankingType === 'performance') {
                rankingsTable.classList.add('performance-stats');
                
                tableHeader.innerHTML = `
                    <div class="rank-col">Rank</div>
                    <div class="player-col">Player</div>
                    <div class="score-col">${getScoreHeaderText(rankingType)}</div>
                    <div class="tournaments-col">Tournaments</div>
                    <div class="trend-col">Trend</div>
                `;
            } else if (rankingType === 'booby') {
                rankingsTable.classList.add('booby-stats');
                
                tableHeader.innerHTML = `
                    <div class="rank-col">Rank</div>
                    <div class="player-col">Player</div>
                    <div class="booby-count-col">Booby Wins</div>
                    <div class="booby-percent-col">Booby %</div>
                    <div class="tournaments-col">Tournaments</div>
                    <div class="trend-col">Trend</div>
                `;
            } else if (rankingType === 'championships') {
                rankingsTable.classList.add('championships-layout');

                tableHeader.innerHTML = `
                    <div class="rank-col">Rank</div>
                    <div class="player-col">Player</div>
                    <div class="wins-col">Wins</div>
                    <div class="podium-col">Top 3</div>
                    <div class="tournaments-col">Tournaments</div>
                    <div class="trend-col">Trend</div>
                `;
            } else {
                // Standard layout for other ranking types
                if (rankingType === 'overall') {
                    rankingsTable.classList.add('seed-stats');
                    tableHeader.innerHTML = `
                        <div class="rank-col">Rank</div>
                        <div class="player-col">Player</div>
                        <div class="score-col">${getScoreHeaderText(rankingType)}</div>
                        <div class="recent-col">Recent (6)</div>
                        <div class="wins-col">Championships</div>
                        <div class="podium-col">Podiums</div>
                        <div class="avg-finish-col">Avg Finish</div>
                        <div class="trend-col">Trend</div>
                    `;
                } else {
                    tableHeader.innerHTML = `
                        <div class="rank-col">Rank</div>
                        <div class="player-col">Player</div>
                        <div class="score-col">${getScoreHeaderText(rankingType)}</div>
                        <div class="tournaments-col">Tournaments</div>
                        <div class="wins-col">Wins</div>
                        <div class="percentage-col">Win %</div>
                        <div class="trend-col">Trend</div>
                    `;
                }
            }
        }
        
        function getScoreHeaderText(rankingType) {
            switch (rankingType) {
                case 'overall':
                    return 'Score';
                case 'championships':
                    return 'Championships';
                case 'recent_form':
                    return 'Form Score';
                case 'performance':
                    return 'Top Percentile Finish Position';
                case 'booby':
                    return 'Booby Wins';
                default:
                    return 'Score';
            }
        }

        function formatScoreDisplay(player, rankingType) {
            switch (rankingType) {
                case 'overall':
                    // Display seed points for Official Seed Ranking system
                    return player.seed_points || Math.round(player.rankingScore || 0);
                case 'championships':
                    return player.tournament_wins || 0;
                case 'career_stats':
                    // Display win percentage (the sorting metric) in the score column
                    const winPct = player.total_rounds > 0 ? ((player.rounds_won / player.total_rounds) * 100).toFixed(1) : '0.0';
                    return `${winPct}%`;
                case 'recent_form':
                    return Math.round(player.rankingScore || 0);
                case 'performance':
                    const percentile = performanceScores.get(player.name);
                    return typeof percentile === 'number' ? `${percentile.toFixed(1)}%` : '‚Äî';
                case 'booby':
                    return player.booby_prizes || 0;
                default:
                    return '0';
            }
        }

        function getInitials(name) {
            return name.split(' ').map(word => word[0]).join('');
        }

        function getPlayerNickname(name) {
            const nicknames = {
                'Margaret Wilson': '"The Ace"',
                'James Ruston': '"The Master"',
                'Emma Jones': '"The Prodigy"',
                'David Smith': '"Steady Eddie"',
                'Tom Wilson': '"The Veteran"',
                'Sarah Brown': '"Lucky Sarah"',
                'Michael Thompson': '"The Professor"',
                'Mary Ruston': '"The Rock"'
            };
            return nicknames[name] || '';
        }

        function generateTrendIndicator(player, currentPosition, rankingType) {
            // Calculate real trend by comparing position before and after most recent tournament
            try {
                if (!tournamentEngine || typeof tournamentEngine.calculatePlayerTrend !== 'function') {
                    // Fallback if trend calculation not available
                    return '‚Äî';
                }
                
                const trend = tournamentEngine.calculatePlayerTrend(player.name, rankingType);
                
                if (trend > 0) {
                    return '<span style="color: #10b981;">‚Üó</span>'; // Green up arrow
                } else if (trend < 0) {
                    return '<span style="color: #ef4444;">‚Üò</span>'; // Red down arrow
                } else {
                    return '<span style="color: #6b7280;">‚Äî</span>'; // Gray dash for no change
                }
            } catch (error) {
                console.warn('Error calculating trend for', player.name, ':', error);
                return '‚Äî';
            }
        }

        function generateChampionshipHistory() {
            const timeline = document.getElementById('champions-timeline');
            
            const champions = [
                { year: 2023, champion: 'Margaret Wilson', highlight: 'Third Consecutive Title' },
                { year: 2022, champion: 'Margaret Wilson', highlight: 'Back-to-Back Champion' },
                { year: 2021, champion: 'Margaret Wilson', highlight: 'Return to Glory' },
                { year: 2020, champion: 'David Smith', highlight: 'COVID Tournament' },
                { year: 2019, champion: 'James Ruston', highlight: 'Veteran Victory' },
                { year: 2018, champion: 'Margaret Wilson', highlight: 'Dominant Performance' },
                { year: 2017, champion: 'Emma Jones', highlight: 'Youngest Winner Record' },
                { year: 2016, champion: 'Tom Wilson', highlight: 'Senior Surprise' }
            ];

            const timelineHTML = champions.map(entry => `
                <div class="champion-entry">
                    <div class="champion-year">${entry.year}</div>
                    <div class="champion-info">
                        <h4 class="champion-name">${entry.champion}</h4>
                        <p class="champion-highlight">${entry.highlight}</p>
                    </div>
                    <div class="champion-medal">üèÜ</div>
                </div>
            `).join('');

            timeline.innerHTML = timelineHTML;
        }

        function loadFallbackData() {
            // Fallback data if tournament engine fails
            console.log('Loading fallback leaderboard data...');
            
            allPlayers = [
                { name: 'Margaret Wilson', tournament_wins: 8, career_wins: 127, win_percentage: '68.0', tournaments_played: 35, top_three_finishes: 23 },
                { name: 'James Ruston', tournament_wins: 12, career_wins: 156, win_percentage: '65.2', tournaments_played: 40, top_three_finishes: 28 },
                { name: 'Emma Jones', tournament_wins: 1, career_wins: 34, win_percentage: '72.1', tournaments_played: 6, top_three_finishes: 4 },
                { name: 'David Smith', tournament_wins: 3, career_wins: 98, win_percentage: '61.8', tournaments_played: 25, top_three_finishes: 18 }
            ];
            
            updateRankingsDisplay('overall');
        }
    </script>

    <style>
        /* Leaderboard specific styles */
        .leaderboard-hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: var(--spacing-3xl) 0;
            position: relative;
            overflow: hidden;
        }

        .leaderboard-hero::before {
            content: 'üèÜ';
            position: absolute;
            top: 50%;
            right: 5%;
            transform: translateY(-50%);
            font-size: 20rem;
            opacity: 0.05;
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .hall-of-fame-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: var(--border-radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            margin-bottom: var(--spacing-lg);
            display: inline-block;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: var(--spacing-md);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
            margin-bottom: var(--spacing-2xl);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .ranking-filters {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            margin-bottom: var(--spacing-xl);
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--border-radius-lg);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .current-rankings {
            padding: var(--spacing-3xl) 0;
        }

        .rankings-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .rankings-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .rankings-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 0;
        }





        .full-rankings {
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }

        .rankings-table {
            width: 100%;
        }

        .rankings-table-header {
            display: grid;
            grid-template-columns: 80px 1.2fr 120px 120px 100px 120px 80px;
            background: var(--primary);
            color: white;
            padding: var(--spacing-lg) var(--spacing-md);
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .rankings-table-header > div {
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .rankings-table-header .score-col {
            color: white;
            font-weight: 600;
        }

        .ranking-row {
            display: grid;
            grid-template-columns: 80px 1.2fr 120px 120px 100px 120px 80px;
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border);
            align-items: center;
            transition: all 0.2s ease;
            color: var(--text-primary-dark);
        }

        .ranking-row:hover {
            background: var(--bg-secondary);
        }

        .ranking-row.podium-row {
            background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 0%, transparent 100%);
        }

        .rank-col {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .rank-medal {
            font-size: 1.125rem;
        }

        .player-link {
            text-decoration: none;
            color: inherit;
        }

        .player-link:hover .player-name {
            color: var(--primary);
        }

        .player-name {
            font-weight: 600;
            transition: color 0.2s ease;
        }

        .player-nickname {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary-dark);
            font-style: italic;
        }

        .score-col {
            font-weight: 700;
            font-family: var(--font-primary);
            color: var(--primary);
            font-size: 1.125rem;
        }

        .trend-col {
            font-size: 1.25rem;
        }

        .rounds-won-col, .rounds-played-col {
            font-weight: 500;
            color: var(--text-primary-dark);
            text-align: center;
        }

        /* Career Stats specific grid layout */
        .career-stats .rankings-table-header {
            grid-template-columns: 80px 1.2fr 140px 140px 120px 80px;
        }

        .career-stats .ranking-row {
            grid-template-columns: 80px 1.2fr 140px 140px 120px 80px;
        }

        .performance-stats .rankings-table-header {
            grid-template-columns: 80px 1.5fr 160px 120px 80px;
        }
        .championships-layout .rankings-table-header {
            grid-template-columns: 80px 1.2fr 120px 120px 120px 80px;
        }
        .seed-stats .rankings-table-header {
            grid-template-columns: 80px 1.5fr 120px 120px 120px 120px 120px 80px;
        }

        .seed-stats .ranking-row {
            grid-template-columns: 80px 1.5fr 120px 120px 120px 120px 120px 80px;
        }

        .performance-stats .ranking-row {
            grid-template-columns: 80px 1.5fr 160px 120px 80px;
        }
        .championships-layout .ranking-row {
            grid-template-columns: 80px 1.2fr 120px 120px 120px 80px;
        }
        .booby-stats .rankings-table-header {
            grid-template-columns: 80px 1.5fr 140px 140px 120px 80px;
        }

        .booby-stats .ranking-row {
            grid-template-columns: 80px 1.5fr 140px 140px 120px 80px;
        }

        .booby-count-col,
        .booby-percent-col {
            text-align: center;
            font-weight: 600;
            color: var(--text-primary-dark);
        }

        .booby-percent-col {
            font-variant-numeric: tabular-nums;
        }

        .ranking-insights {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-secondary);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-xl);
        }

        .insight-card {
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-card);
            border: 2px solid var(--card-border);
            transition: all 0.2s ease;
        }

        .insight-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .insight-card.featured {
            border-color: var(--gold);
            background: linear-gradient(135deg, var(--card-bg) 0%, #fef3c7 100%);
        }

        .insight-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-lg);
        }

        .insight-content h3,
        .insight-card h3 {
            color: var(--text-primary-dark);
            margin-bottom: var(--spacing-md);
        }

        .insight-content p {
            color: var(--text-primary-dark);
            line-height: 1.6;
        }

        .insight-stat {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-top: var(--spacing-lg);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--border);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 900;
            font-family: var(--font-primary);
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary-dark);
        }

        .historical-champions {
            padding: var(--spacing-3xl) 0;
        }

        .champions-timeline {
            display: grid;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-2xl);
        }

        .champion-entry {
            display: grid;
            grid-template-columns: 80px 1fr auto;
            gap: var(--spacing-lg);
            align-items: center;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-sm);
        }

        .champion-year {
            font-size: 1.5rem;
            font-weight: 900;
            font-family: var(--font-primary);
            color: var(--primary);
        }

        .champion-name {
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .champion-highlight {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0;
        }

        .champion-medal {
            font-size: 2rem;
        }

        .championship-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-xl);
        }

        .records-section {
            padding: var(--spacing-3xl) 0;
            background: var(--bg-secondary);
        }

        .records-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-2xl);
        }

        .record-category h3 {
            color: var(--primary);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--primary);
        }

        .record-list {
            display: grid;
            gap: var(--spacing-md);
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            gap: var(--spacing-lg);
        }

        .record-title {
            font-weight: 500;
            color: var(--text-primary-dark);
        }

        .record-holder {
            font-weight: 600;
            color: var(--primary);
        }

        .data-issues-banner {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-bottom: 2px solid #ef4444;
            padding: var(--spacing-md) 0;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.25);
        }

        .data-issues-banner__content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 var(--spacing-md);
            color: #991b1b;
        }

        .data-issues-banner__content strong {
            display: inline-block;
            margin-bottom: var(--spacing-sm);
        }

        .data-issues-banner__content ul {
            margin: 0;
            padding-left: 1.25rem;
        }

        .data-issues-banner__content li {
            margin-bottom: 0.35rem;
        }

        .data-issues-banner__errors + .data-issues-banner__warning {
            margin-top: var(--spacing-md);
            padding-top: var(--spacing-md);
            border-top: 1px solid rgba(153, 27, 27, 0.25);
        }

        .data-issues-banner__warning {
            color: #7f1d1d;
        }

        .data-issues-banner__warning-header {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
            margin-bottom: 0.35rem;
        }

        .data-issues-banner__pill {
            background: rgba(153, 27, 27, 0.1);
            border: 1px solid rgba(153, 27, 27, 0.3);
            border-radius: 999px;
            padding: 0.1rem 0.75rem;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .data-issues-banner__warning-list {
            margin: 0.35rem 0 0.35rem 1.25rem;
            padding-left: 0;
        }

        .data-issues-banner__warning-list li {
            margin-bottom: 0.25rem;
        }

        .data-issues-banner__dismiss {
            background: rgba(185, 28, 28, 0.1);
            border: 1px solid rgba(185, 28, 28, 0.4);
            border-radius: 999px;
            color: inherit;
            padding: 0.35rem 0.9rem;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .data-issues-banner__dismiss:hover {
            background: rgba(185, 28, 28, 0.2);
            transform: translateY(-1px);
        }

        /* Table Controls Styling */
        .table-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: var(--spacing-xl) 0;
            margin-top: var(--spacing-lg);
            border-top: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .toggle-view-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            gap: var(--spacing-sm);
            background: var(--card-bg);
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: var(--border-radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
            white-space: nowrap;
            writing-mode: horizontal-tb;
            min-width: 0;
        }

        .toggle-view-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .toggle-view-btn.showing-all {
            background: var(--primary);
            color: white;
        }

        .toggle-view-btn.showing-all:hover {
            background: var(--primary-dark);
        }

        .btn-icon {
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .ranking-filters {
                flex-direction: column;
                align-items: center;
                gap: var(--spacing-sm);
                margin-bottom: var(--spacing-lg);
            }
            
            .rankings-title {
                font-size: 1.75rem;
            }
            
            .rankings-subtitle {
                font-size: 0.9rem;
            }
            
            .rankings-table-header,
            .ranking-row {
                grid-template-columns: 60px 1fr 80px 60px;
            }
            
            .tournaments-col,
            .percentage-col,
            .trend-col {
                display: none;
            }
            
            .records-grid {
                grid-template-columns: 1fr;
            }
            
            .table-controls {
                padding: var(--spacing-lg) 0;
            }
            
            .toggle-view-btn {
                padding: var(--spacing-sm) var(--spacing-lg);
                font-size: 0.8rem;
            }
        }
    </style>
</body>
</html>