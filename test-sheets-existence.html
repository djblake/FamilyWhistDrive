<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Sheet Existence</title>
</head>
<body>
    <h1>Debug Sheet Existence</h1>
    <button onclick="testSheetExistence()">Test Sheet Existence</button>
    <div id="results"></div>

    <script>
        async function testSheetExistence() {
            const sheetId = '1HGfdlDOfGHOL6Q4MP_TnF8UNE6YihBW-5gQs6Ykl78k';
            const testSheets = ['WhistGame_2020', 'WhistGame_2021', 'WhistGame_2022', 'WhistGame_2023', 'WhistGame_2024'];
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h2>Testing...</h2>';
            
            const results = [];
            
            for (const sheetName of testSheets) {
                try {
                    const encodedName = encodeURIComponent(sheetName);
                    const csvUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${encodedName}`;
                    
                    console.log(`Testing ${sheetName}...`);
                    const response = await fetch(csvUrl);
                    const csvData = await response.text();
                    
                    results.push({
                        name: sheetName,
                        status: response.status,
                        ok: response.ok,
                        contentLength: csvData.length,
                        firstLine: csvData.split('\n')[0],
                        totalLines: csvData.split('\n').length,
                        content: csvData.substring(0, 500) // First 500 chars
                    });
                    
                } catch (error) {
                    results.push({
                        name: sheetName,
                        error: error.message
                    });
                }
            }
            
            // Display results
            let html = '<h2>Results:</h2>';
            results.forEach(result => {
                html += `
                    <div style="border: 1px solid #ccc; margin: 10px 0; padding: 10px;">
                        <h3>${result.name}</h3>
                        ${result.error ? 
                            `<p style="color: red;">Error: ${result.error}</p>` :
                            `
                            <p>Status: ${result.status} (${result.ok ? 'OK' : 'NOT OK'})</p>
                            <p>Content Length: ${result.contentLength}</p>
                            <p>Total Lines: ${result.totalLines}</p>
                            <p>First Line: <code>${result.firstLine}</code></p>
                            <details>
                                <summary>Raw Content (first 500 chars)</summary>
                                <pre>${result.content}</pre>
                            </details>
                            `
                        }
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }
    </script>
</body>
</html> 